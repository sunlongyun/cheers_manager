<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>酒水饮料销售管理</title>
<meta
	content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no'
	name='viewport'>
<meta name="description" content="Developed By M Abdur Rokib Promy">
<meta name="keywords"
	content="Admin, Bootstrap 3, Template, Theme, Responsive">
<!-- bootstrap 3.0.2 -->
<link href="html/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<!-- font Awesome -->
<link href="html/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<!-- Ionicons -->
<link href="html/css/ionicons.min.css" rel="stylesheet" type="text/css" />
<!-- Morris chart -->
<link href="html/css/morris/morris.css" rel="stylesheet" type="text/css" />
<!-- jvectormap -->
<link href="html/css/jvectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet"
	type="text/css" />
<!-- Date Picker -->
<link href="html/css/datepicker/datepicker3.css" rel="stylesheet"
	type="text/css" />
<!-- fullCalendar -->
<!-- <link href="css/fullcalendar/fullcalendar.css" rel="stylesheet" type="text/css" /> -->
<!-- Daterange picker -->
<link href="html/css/daterangepicker/daterangepicker-bs3.css"
	rel="html/stylesheet" type="text/css" />
<!-- iCheck for checkboxes and radio inputs -->
<link href="html/css/iCheck/all.css" rel="stylesheet" type="text/css" />
<!-- bootstrap wysihtml5 - text editor -->
<!-- <link href="css/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css" rel="stylesheet" type="text/css" /> -->
<link href='http://fonts.googleapis.com/css?family=Lato'
	rel='stylesheet' type='text/css'>
<!-- Theme style -->
<link href="html/css/style.css" rel="stylesheet" type="text/css" />

</head>
<body class="skin-black">
	<!-- header logo: style can be found in header.less -->
	<header class="header">
		<a href="/" class="logo"> 酒水饮料销售管理 </a>
		<!-- Header Navbar: style can be found in header.less -->
		<nav class="navbar navbar-static-top" role="navigation">
			<!-- Sidebar toggle button-->
			<a href="javascript:void(0)" class="navbar-btn sidebar-toggle" data-toggle="offcanvas"
				role="button"> <span class="sr-only">Toggle navigation</span> <span
				class="icon-bar"></span> <span class="icon-bar"></span> <span
				class="icon-bar"></span>
			</a>
			<div class="navbar-right">
				<ul class="nav navbar-nav">
					<li class="dropdown user user-menu"><a href="#"
						class="dropdown-toggle" data-toggle="dropdown"> <i
							class="fa fa-user"></i> <span><i class='userName'>admin</i> <i class="caret"></i></span>
					</a>
						<ul class="dropdown-menu dropdown-custom dropdown-menu-right">
							<li class="dropdown-header text-center">Account</li>
							<li><a id="changePassword"><i class="glyphicon glyphicon-pencil"></i>
									修改密码</a></li>
							<li><a id="loginOut"><i class="glyphicon glyphicon-ban-circle"></i>
									退出</a></li>
						</ul></li>
				</ul>
			</div>
		</nav>
	</header>
	<div class="wrapper row-offcanvas row-offcanvas-left">
		<!-- Left side column. contains the logo and sidebar -->
		<aside class="left-side sidebar-offcanvas">
			<!-- sidebar: style can be found in sidebar.less -->
			<section class="sidebar">
				<!-- Sidebar user panel -->
				<div class="user-panel">
					<div class="pull-left image">
						<img src="html/img/26115.jpg" class="img-circle" alt="User Image" />
					</div>
					<div class="pull-left info">
						<p>Hello, [<i class='userName'>admin</i>]</p>
					</div>
				</div>
				<ul class="sidebar-menu">
					<li>
						<a data-href="/"> <i class="glyphicon glyphicon glyphicon-home"></i> <span>首页</span></a>
					</li>
					<li>
						<a data-href="/adminList"> <i class="glyphicon glyphicon-user"></i> <span>管理员管理</span></a>
					</li>
					<li>
						<a data-href="/goodsList"> <i class="glyphicon glyphicon-th-list"></i> <span>商品管理</span></a>
					</li>
					<li>
						<a data-href="/customerList"> <i class="glyphicon glyphicon-th-list"></i> <span>客户管理</span></a>
					</li>
					<li class="active">
						<a data-href="/salesOrderList"> <i class="glyphicon glyphicon-th-list"></i> <span>销售列表</span></a>
					</li>
					<li>
						<a data-href="/fileList"> <i class="fa fa-file"></i> <span>图片管理</span></a>
					</li>
					<li>
						<a data-href="/imgWords"> <i class="glyphicon glyphicon-cloud"></i> <span>图片文识别</span></a>
					</li>      
				</ul>
			</section>
		</aside>
		<aside class="right-side">
			<!-- Main content -->
			<section class="content">
				<div class="row">
					<div class="panel">
						<header class="panel-heading">
                                                                     销售订单列表
                        </header>
	                    <div class="panel-body">
							<form class="form-inline" id="form" role="form">
							  <div class="form-group">
							    <input type="text" class="form-control" name="code"  placeholder="订单编码">
							  </div>
							  <div class="form-group">
							    <input type="text" class="form-control" name="customerCompanyName"  placeholder="客户公司名称">
							  </div>
							  <button type="button" class="btn btn-primary" onclick="search()"><span class="glyphicon glyphicon-search"></span>&nbsp;查询</button>
							  &nbsp;
							  <button type="button" class="btn btn-primary" onclick="add()"><span class="glyphicon glyphicon-plus"></span>&nbsp;新增</button>
							</form>
							<table id="table" class="text-center table table-bordered table-hover  table-striped"></table>
	                    </div>
					</div>
				</div>
			</section>
		</aside>
	</div>
	<!-- jQuery 2.0.2 -->
	<script src="html/js/jquery.min.js" type="text/javascript"></script>
	<!-- Bootstrap -->
	<script src="html/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="html/js/bootstrap-paginator.js" type="text/javascript"></script>
	<script type="text/javascript" src="html/js/crc.js"></script>
	<script type="text/javascript" src="html/js/common.js"></script>
	<script type="text/javascript">
		/**
		** 查询
		**/
		function search(){
			/**
			** 调用分页 
			**/
			$("#table").search2('/order/getPageInfo','form',
		            [
		            	{"text":"订单编码","title":"code"},
		                {"text":"订单总金额","title":"totalAmount"},
		                {"text":"支付总金额","title":"payAmount"},
		                {"text":"客户公司","title":"customerCompanyName"},
		                {"text":"购物清单","title":"buyerDetail"},
		                {"text":"支付状态","title":"payStatus"},
		                {"text":"创建人","title":"creator"},
		                {"text":"创建时间","title":"createTime"}
		            ]
		        );
		}
		search();

		//添加
		function add(){
			var html = '<div class="form-group">'+
		    '<label for="customerId" class="col-sm-3 control-label">选择客户:</label>'+
		    '<div class="col-sm-7">'+
		      '<input type="text" class="form-control" id="customerId" value="" placeholder="客户id(从客户列表粘贴)">'+
		    '</div>'+
		  '</div>';
		  html += '<div class="form-group">'+
		    '<label  class="col-sm-3 control-label">商品id:</label>'+
		    '<div class="col-sm-7">'+
		      '<input type="text" class="form-control" id="goodsId" value="" placeholder="从商品列表粘贴,多个商品用,隔开id">'+
		    '</div>'+
		  '</div>';
		  html += '<div class="form-group">'+
		    '<label  class="col-sm-3 control-label">商品数量:</label>'+
		    '<div class="col-sm-7">'+
		      '<input type="text"  class="form-control" id="goodsNum" value="" placeholder="和id对应的商品数量,多个商品用,隔开">'+
		    '</div>'+
		  '</div>';
		  html += '<div class="form-group">'+
		    '<label for="roomCards" class="col-sm-3 control-label">是否已支付:</label>'+
		    '<div class="col-sm-7">'+
		      '<input type="radio"  name="paySatus" value="0" checked="true">  未支付'+
		      '&nbsp;&nbsp;<input type="radio"  name="paySatus" value="1" >  已支付'+
		    '</div>'+
		  '</div>';
			$.dialog("添加商品订单", html,function(){
				
				var customerId = $("#customerId").val().trim();
				var paySatus = $("input:checked[name='paySatus']").val().trim();
				var goodsIdList = $("#goodsId").val().trim();
				var goodsNumList = $("#goodsNum").val().trim();
				
				if(!customerId){
					alert("客户id不能为空");
					return false;
				}
				if(!goodsIdList){
					alert("商品ID列表空!");
					return false;
				}
				if(!goodsNumList){
					alert("商品数量列表不能为空!");
					return false;
				}
				var goodsIdArr = goodsIdList.split(",");
				var goodsNumArr = goodsNumList.split(",");
				if(goodsIdArr.length != goodsNumArr.length){
					alert("商品id和商品数量数目不相等!");
					return false;
				}
				var orderGoodsMappingList =[];
				for(var i =0;i < goodsIdArr.length;i++ ){
					var goodsId = goodsIdArr[i];
					var goodsNum = goodsNumArr[i];
					var goods = {};
					goods["goodsId"]=goodsId;
					goods["goodsNum"]= goodsNum;
					
					orderGoodsMappingList.push(goods);
				}
				
				$.ajax({
					url:'/order/save',
					type:'post',
					dataType:'json',
					contentType:'application/json;charset=utf-8',
					data:JSON.stringify({
						"customerId":customerId,
						"payStatus":paySatus,
						"orderGoodsMappingList":orderGoodsMappingList
					}),
					success:function(res){
						if(res.code == '0000'){
							$.dialogClose();
							search();
						}else{
							alert("添加失败，请联系管理员");
						}
					},error:function(){
						alert("添加失败");
					}
				});
				
			},null, 180);
			
		}
		
	</script>
</body>
</html>